---
title: "SERDP_datacleaning"
author: "Jake Eisaguirre"
date: "7/18/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

if (!require(librarian)){
  install.packages("librarian")
  library(librarian)
}

librarian::shelf(tidyverse, here, purrr, parsedate, lubridate, janitor)
```

```{r}
# common_colnames  <- intersect(colnames(site_level_data_2017), colnames(site_level_data_2018_LA)) %>%
#   intersect(colnames(site_level_data_2018_NM)) %>%
#   intersect(colnames(site_level_data_2018_PA)) %>%
#   intersect(colnames(site_level_data_2018_TN)) %>%
#   intersect(colnames(site_level_data_2018_VT)) %>%
#   intersect(colnames(site_level_data_2019_LA)) %>% 
#   intersect(colnames(site_level_data_2019_NM)) %>%
#   intersect(colnames(site_level_data_2019_PA)) %>%
#   intersect(colnames(site_level_data_2019_TN)) %>%
#   intersect(colnames(site_level_data_2019_VT)) %>%
#   write_rds(here("site_level_common_colnames.rds"))
```


# site_level data - this code chunk is ugly AF need to create loop for this
```{r}
# 37 common col names across sites
site_level_common_colnames <- read_rds(here("site_level_common_colnames.rds"))

# all 2017 site level data
site_level_data_2017 <- read_csv(here("data", "site_level_data", "2017_site_data", 
                                      "site_level_data_2017_all.csv")) %>% 
  clean_names() %>% 
  mutate(date = parse_date(date),
         end_time = parse_time(end_time),
         start_time = parse_time(start_time)) %>% 
  select(site_level_common_colnames)
  
# 2018 site level data
site_level_data_2018_LA <- read_csv(here("data", "site_level_data", "2018_site_data", "LA_site_2018.csv")) %>%
  clean_names() %>% 
  mutate(date = parse_date(date))%>% 
  select(site_level_common_colnames)

site_level_data_2018_NM <- read_csv(here("data", "site_level_data", "2018_site_data", "NM_site_2018.csv"))  %>%
  clean_names() %>%
  mutate(date = parse_date(date))%>% 
  select(site_level_common_colnames)

site_level_data_2018_PA <- read_csv(here("data", "site_level_data", "2018_site_data", "PA_site_2018.csv")) %>%
  clean_names() %>%
  mutate(date = parse_date(date))%>% 
  select(site_level_common_colnames)

site_level_data_2018_TN <- read_csv(here("data", "site_level_data", "2018_site_data", "TN_site_2018.csv")) %>%
  clean_names() %>%
  mutate(date = parse_date(date))%>% 
  select(site_level_common_colnames)

site_level_data_2018_VT <- read_csv(here("data", "site_level_data", "2018_site_data", "VT_site_2018.csv")) %>% 
  clean_names() %>%
  mutate(date = parse_date(date))%>% 
  select(site_level_common_colnames)

# 2019 site level data
site_level_data_2019_LA <- read_csv(here("data", "site_level_data", "2019_site_data", "LA_site_2019.csv")) %>%
  clean_names() %>% 
  mutate(date = parse_date(date))%>% 
  select(site_level_common_colnames)

site_level_data_2019_NM <- read_csv(here("data", "site_level_data", "2019_site_data", "NM_site_2019.csv"))  %>%
  clean_names() %>%
  mutate(date = parse_date(date))%>% 
  select(site_level_common_colnames)

site_level_data_2019_PA <- read_csv(here("data", "site_level_data", "2019_site_data", "PA_site_2019.csv")) %>%
  clean_names() %>%
  mutate(date = parse_date(date))%>% 
  select(site_level_common_colnames)

site_level_data_2019_TN <- read_csv(here("data", "site_level_data", "2019_site_data", "TN_site_2019.csv")) %>%
  clean_names() %>%
  mutate(date = parse_date(date))%>% 
  select(site_level_common_colnames)

site_level_data_2019_VT <- read_csv(here("data", "site_level_data", "2019_site_data", "VT_site_2019.csv")) %>% 
  clean_names() %>%
  mutate(date = parse_date(date))%>% 
  select(site_level_common_colnames)




site_level_data <- as.data.frame(rbind(site_level_data_2017, site_level_data_2018_LA, 
                                      site_level_data_2018_NM, site_level_data_2018_PA,
                                      site_level_data_2018_TN, site_level_data_2018_VT,
                                      site_level_data_2019_LA, 
                                      site_level_data_2019_NM, site_level_data_2019_PA,
                                      site_level_data_2019_TN, site_level_data_2019_VT))

write_csv(site_level_data, here("data", "site_level_data", "all_site_level_data.csv"))


```

